<santa xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="santa.xsd">
  <replicates>1</replicates>

  <simulation>
    <genome>
      <length>1701</length>
      <sequences>
        ATGAAGACTATCATTGCTTTGAGCTACATTTTATGTCTGGTTTTCGCTCAAAAACTTCCCGGAAATGACAACAGCACAGCAACGCTGTGCCTGGGACATCATGCAGTGCCAAACGGAACGCTAGTGAAAACAATCACGAATGATCAAATTGAAGTGACTAATGCTACTGAGCTGGTTCAGAGTTCCTCAACAGGTAGAATATGCGACAGTCCTCACCGAATCCTTGATGGAAAAAACTGCACACTGATAGATGCTCTATTGGGAGACCCTCATTGTGATGGCTTCCAAAATAAGGAATGGGACCTTTTTGTTGAACGCAGCAAAGCTTACAGCAACTGTTACCCTTATGATGTACCGGATTATGCCTCCCTTAGGTCACTAGTTGCCTCATCAGGCACCCTGGAGTTTATCAATGAAGACTTCAATTGGACTGGAGTCGCTCAGGATGGGGGAAGCTATGCTTGCAAAAGGGGATCTGTTAACAGTTTCTTTAGTAGATTGAATTGGTTGCACAAATCAGAATACAAATATCCAGCGCTGAACGTGACTATGCCAAACAATGGCAAATTTGACAAATTGTACATTTGGGGGGTTCACCACCCGAGCACGGACAGAGACCAAACCAGCCTATATGTTCGAGCATCAGGGAGAGTCACAGTCTCTACCAAAAGAAGCCAACAAACTGTAACCCCGAATATCGGGTCTAGACCCTGGGTAAGGGGTCAGTCCAGTAGAATAAGCATCTATTGGACAATAGTAAAACCGGGAGACATACTTTTGATTAATAGCACAGGGAATCTAATTGCTCCTCGGGGTTACTTCAAAATACGAAATGGGAAAAGCTCAATAATGAGGTCAGATGCACCCATTGGCACCTGCAGTTCTGAATGCATCACTCCAAATGGAAGCATTCCCAATGACAAACCTTTTCAAAATGTAAACAGGATCACATATGGGGCCTGCCCCAGATATGTTAAGCAAAACACTCTGAAATTGGCAACAGGGATGCGGAATGTACCAGAGAAACAAACTAGAGGCATATTCGGCGCAATCGCAGGTTTCATAGAAAATGGTTGGGAGGGAATGGTAGACGGTTGGTACGGTTTCAGGCATCAAAATTCTGAGGGCACAGGACAAGCAGCAGATCTTAAAAGCACTCAAGCAGCAATCGACCAAATCAACGGGAAACTGAATAGGTTAATCGAGAAAACGAACGAGAAATTCCATCAAATCGAAAAAGAATTCTCAGAAGTAGAAGGGAGAATTCAGGACCTCGAGAAATATGTTGAAGACACTAAAATAGATCTCTGGTCTTACAACGCGGAGCTTCTTGTTGCCCTGGAGAACCAACATACAATTGATCTTACTGACTCAGAAATGAACAAACTGTTTGAAAAAACAAGGAAGCAACTGAGGGAAAATGCTGAGGACATGGGCAATGGTTGCTTCAAAATATACCACAAATGTGACAATGCCTGCATAGGGTCAATCAGAAATGGAACTTATGACCATGATGTATACAGAGACGAAGCATTAAACAACCGGTTCCAGATCAAAGGTGTTGAGCTGAAGTCAGGATACAAAGATTGGATCCTGTGGATTTCCTTTGCCATATCATGCTTTTTGCTTTGTGTTGTTTTGCTGGGGTTCATCATGTGGGCCTGCCAAAAAGGCAACATTAGGTGTAACATTTGCATTTGA
      </sequences>
      <feature>
        <name>CDS</name>
        <type>aminoAcid</type>
        <coordinates>1-1701</coordinates>
      </feature>
      <feature>
        <name>SigPep</name>
        <type>aminoAcid</type>
        <coordinates>1-48</coordinates>
      </feature>
      <feature>
        <name>HA1</name>
        <type>aminoAcid</type>
        <coordinates>49-1035</coordinates>
      </feature>
      <feature>
        <name>HA2</name>
        <type>aminoAcid</type>
        <coordinates>1036-1698</coordinates>
      </feature>
    </genome>

    <population>
      <populationSize>10000</populationSize>

      <inoculum>all</inoculum>
    </population>

    <fitnessFunction>
      <!-- The signal peptide, HA1, and HA2 are generally under purifying selection except for epitope sites. -->
      <purifyingFitness>
        <feature>SigPep</feature>
        <rank>
          <order>chemical</order>
          <breakTies>ordered</breakTies>
          <probableSet>12</probableSet>
        </rank>
        <fitness>
          <lowFitness>0.5</lowFitness>
          <minimumFitness>0.1</minimumFitness>
        </fitness>
      </purifyingFitness>

      <purifyingFitness>
        <feature>HA1</feature>
        <sites>1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,49,52,55,56,58,60,61,64,65,66,68,69,70,71,72,73,74,76,77,79,84,85,89,90,93,95,97,98,99,100,101,104,105,106,107,108,110,111,112,113,114,115,116,118,119,120,123,125,127,134,136,139,141,147,148,149,151,153,154,160,161,162,164,166,169,178,180,181,183,184,185,191,195,199,200,202,204,205,206,210,211,220,221,222,223,224,225,231,232,233,234,235,236,237,239,241,243,245,249,250,251,252,253,254,255,256,257,258,259,263,264,266,267,268,269,270,271,272,274,277,281,282,283,284,285,286,287,288,289,290,291,292,293,295,296,298,301,302,303,306,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329</sites>
        <rank>
          <order>chemical</order>
          <breakTies>ordered</breakTies>
          <probableSet>12</probableSet>
        </rank>
        <fitness>
          <lowFitness>0.5</lowFitness>
          <minimumFitness>0.1</minimumFitness>
        </fitness>
      </purifyingFitness>

      <!-- HA1 epitope sites are still subject to some purifying selection but less than non-epitope sites. -->
      <purifyingFitness>
        <feature>HA1</feature>
        <sites>44,45,46,47,48,50,51,53,54,57,59,62,63,67,75,78,80,81,82,83,86,87,88,91,92,94,96,102,103,109,117,121,122,124,126,128,129,130,131,132,133,135,137,138,140,142,143,144,145,146,150,152,155,156,157,158,159,163,165,167,168,170,171,172,173,174,175,176,177,179,182,186,187,188,189,190,192,193,194,196,197,198,201,203,207,208,209,212,213,214,215,216,217,218,219,226,227,228,229,230,238,240,242,244,246,247,248,260,261,262,265,273,275,276,278,279,280,294,297,299,300,304,305,307,308,309,310,311,312</sites>
        <rank>
          <order>chemical</order>
          <breakTies>ordered</breakTies>
          <probableSet>12</probableSet>
        </rank>
        <fitness>
          <lowFitness>0.95</lowFitness>
          <minimumFitness>0.9</minimumFitness>
        </fitness>
      </purifyingFitness>

      <purifyingFitness>
        <feature>HA2</feature>
        <rank>
          <order>chemical</order>
          <breakTies>ordered</breakTies>
          <probableSet>12</probableSet>
        </rank>
        <fitness>
          <lowFitness>0.5</lowFitness>
          <minimumFitness>0.1</minimumFitness>
        </fitness>
      </purifyingFitness>

      <!-- Amino acid positions of Wolf et al. 2006 epitope sites in HA1 coordinates are under positive selection based on their exposure history. -->
      <empiricalFitness>
        <feature>HA1</feature>
        <sites>44,45,46,47,48,50,51,53,54,57,59,62,63,67,75,78,80,81,82,83,86,87,88,91,92,94,96,102,103,109,117,121,122,124,126,128,129,130,131,132,133,135,137,138,140,142,143,144,145,146,150,152,155,156,157,158,159,163,165,167,168,170,171,172,173,174,175,176,177,179,182,186,187,188,189,190,192,193,194,196,197,198,201,203,207,208,209,212,213,214,215,216,217,218,219,226,227,228,229,230,238,240,242,244,246,247,248,260,261,262,265,273,275,276,278,279,280,294,297,299,300,304,305,307,308,309,310,311,312</sites>

        <!-- Assign fitness 1 all amino acids at epitope sites. -->
        <values>
          1 <!-- A -->
          1 <!-- C -->
          1 <!-- D -->
          1 <!-- E -->
          1 <!-- F-->
          1 <!-- G -->
          1 <!-- H -->
          1 <!-- I -->
          1 <!-- K -->
          1 <!-- L -->
          1 <!-- M -->
          1 <!-- N -->
          1 <!-- P -->
          1 <!-- Q -->
          1 <!-- R -->
          1 <!-- S -->
          1 <!-- T -->
          1 <!-- V -->
          1 <!-- W -->
          1 <!-- Y -->
        </values>
      </empiricalFitness>

      <exposureDependentFitness>
        <feature>HA1</feature>
        <sites>44,45,46,47,48,50,51,53,54,57,59,62,63,67,75,78,80,81,82,83,86,87,88,91,92,94,96,102,103,109,117,121,122,124,126,128,129,130,131,132,133,135,137,138,140,142,143,144,145,146,150,152,155,156,157,158,159,163,165,167,168,170,171,172,173,174,175,176,177,179,182,186,187,188,189,190,192,193,194,196,197,198,201,203,207,208,209,212,213,214,215,216,217,218,219,226,227,228,229,230,238,240,242,244,246,247,248,260,261,262,265,273,275,276,278,279,280,294,297,299,300,304,305,307,308,309,310,311,312</sites>
        <penalty>0.001</penalty>
      </exposureDependentFitness>
    </fitnessFunction>

    <mutator>
      <nucleotideMutator>
        <mutationRate>1.0E-4</mutationRate>
        <transitionBias>2.0</transitionBias>
      </nucleotideMutator>
    </mutator>

    <replicator>
      <clonalReplicator/>
    </replicator>

    <epoch>
      <generationCount>5000</generationCount>
    </epoch>

    <samplingSchedule>
      <sampler>
        <atFrequency>10</atFrequency>
        <fileName>simulated_HA_sequences.fasta</fileName>
        <alignment>
          <sampleSize>10</sampleSize>
          <format>FASTA</format>
          <label>sample_%g_%s|%g</label>
        </alignment>
      </sampler>
      <sampler>
        <atFrequency>10</atFrequency>
        <fileName>exposure.csv</fileName>
        <statistics></statistics>
      </sampler>
    </samplingSchedule>

  </simulation>

</santa>
